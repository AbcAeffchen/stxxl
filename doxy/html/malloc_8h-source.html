<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>&lt;stxxl&gt;: malloc.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>malloc.h</h1><div class="fragment"><pre>00001  <span class="comment">/***************************************************************************</span>
00002 <span class="comment"> *            malloc.h</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> *  Sun Jun 22 22:26:14 2003</span>
00005 <span class="comment"> *  Copyright  2003  Roman Dementiev</span>
00006 <span class="comment"> *  dementiev@mpi-sb.mpg.de</span>
00007 <span class="comment"> ****************************************************************************/</span>
00008 <span class="preprocessor">#include "../common/utils.h"</span>
00009 <span class="preprocessor">#include &lt;ostream&gt;</span>
00010 <span class="preprocessor">#include &lt;malloc.h&gt;</span>
00011 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00012 
00013 __STXXL_BEGIN_NAMESPACE
00014 
00015 
00017 
<a name="l00019"></a><a class="code" href="classstxxl_1_1malloc__stats.html">00019</a> <span class="keyword">class </span><a class="code" href="classstxxl_1_1malloc__stats.html">malloc_stats</a>
00020 {
00021 <span class="keyword">public</span>:
00022   <span class="keyword">typedef</span> <span class="keywordtype">int</span> return_type;
00023   
<a name="l00025"></a><a class="code" href="classstxxl_1_1malloc__stats.html#a0">00025</a>   return_type  from_system_nmmap()<span class="keyword"> const</span>
00026 <span class="keyword">  </span>{
00027     <span class="keyword">struct </span>mallinfo info = mallinfo();
00028     <span class="keywordflow">return</span> info.arena;
00029   }
00030   
<a name="l00032"></a><a class="code" href="classstxxl_1_1malloc__stats.html#a1">00032</a>   return_type free_chunks()<span class="keyword"> const</span>
00033 <span class="keyword">  </span>{
00034     <span class="keyword">struct </span>mallinfo info = mallinfo();
00035     <span class="keywordflow">return</span> info.ordblks;
00036   }
00037   
<a name="l00039"></a><a class="code" href="classstxxl_1_1malloc__stats.html#a2">00039</a>   return_type used()<span class="keyword"> const</span>
00040 <span class="keyword">  </span>{
00041     <span class="keyword">struct </span>mallinfo info = mallinfo();
00042     <span class="keywordflow">return</span> info.uordblks;
00043   }
00044   
<a name="l00046"></a><a class="code" href="classstxxl_1_1malloc__stats.html#a3">00046</a>   return_type not_used()<span class="keyword"> const</span>
00047 <span class="keyword">  </span>{
00048     <span class="keyword">struct </span>mallinfo info = mallinfo();
00049     <span class="keywordflow">return</span> info.fordblks;
00050   }
00051   
<a name="l00053"></a><a class="code" href="classstxxl_1_1malloc__stats.html#a4">00053</a>   return_type releasable()<span class="keyword"> const</span>
00054 <span class="keyword">  </span>{
00055     <span class="keyword">struct </span>mallinfo info = mallinfo();
00056     <span class="keywordflow">return</span> info.keepcost;
00057   }
00058   
<a name="l00060"></a><a class="code" href="classstxxl_1_1malloc__stats.html#a5">00060</a>   return_type max_allocated()<span class="keyword"> const</span>
00061 <span class="keyword">  </span>{
00062     <span class="keyword">struct </span>mallinfo info = mallinfo();
00063     <span class="keywordflow">return</span> info.usmblks;
00064   }
00065   
<a name="l00067"></a><a class="code" href="classstxxl_1_1malloc__stats.html#a6">00067</a>   return_type fastbin_blocks()<span class="keyword"> const</span>
00068 <span class="keyword">  </span>{
00069     <span class="keyword">struct </span>mallinfo info = mallinfo();
00070     <span class="keywordflow">return</span> info.smblks;
00071   }
00072   
<a name="l00074"></a><a class="code" href="classstxxl_1_1malloc__stats.html#a7">00074</a>   return_type fastbin_free()<span class="keyword"> const</span>
00075 <span class="keyword">  </span>{
00076     <span class="keyword">struct </span>mallinfo info = mallinfo();
00077     <span class="keywordflow">return</span> info.fsmblks;
00078   }
00079    
<a name="l00081"></a><a class="code" href="classstxxl_1_1malloc__stats.html#a8">00081</a>   return_type  from_system_mmap()<span class="keyword"> const</span>
00082 <span class="keyword">  </span>{
00083     <span class="keyword">struct </span>mallinfo info = mallinfo();
00084     <span class="keywordflow">return</span> info.hblkhd;
00085   }
00086   
<a name="l00088"></a><a class="code" href="classstxxl_1_1malloc__stats.html#a9">00088</a>   return_type mmap_chunks()<span class="keyword"> const</span>
00089 <span class="keyword">  </span>{
00090     <span class="keyword">struct </span>mallinfo info = mallinfo();
00091     <span class="keywordflow">return</span> info.hblks;
00092   }
00093   
<a name="l00095"></a><a class="code" href="classstxxl_1_1malloc__stats.html#a10">00095</a>   return_type  from_system_total()<span class="keyword"> const</span>
00096 <span class="keyword">  </span>{
00097     <span class="keywordflow">return</span> from_system_nmmap() + from_system_mmap();
00098   }
00099   
00100 };
00101 
<a name="l00103"></a><a class="code" href="namespacestxxl.html#a91">00103</a> std::ostream &amp; operator &lt;&lt; (std::ostream &amp; s, <span class="keyword">const</span> <a class="code" href="classstxxl_1_1malloc__stats.html">malloc_stats</a> &amp; st)
00104 {
00105   s &lt;&lt; <span class="stringliteral">"MALLOC statistics"</span> &lt;&lt; std::endl;
00106   s &lt;&lt; <span class="stringliteral">"================================================================="</span> &lt;&lt; std::endl ;
00107   s &lt;&lt; <span class="stringliteral">"Space allocated from system not using mmap: "</span>&lt;&lt;st.<a class="code" href="classstxxl_1_1malloc__stats.html#a0">from_system_nmmap</a>() &lt;&lt; <span class="stringliteral">" bytes"</span>&lt;&lt;std::endl ;
00108   s &lt;&lt; <span class="stringliteral">"       number of free chunks                       : "</span>&lt;&lt;st.<a class="code" href="classstxxl_1_1malloc__stats.html#a1">free_chunks</a>() &lt;&lt; std::endl;
00109   s &lt;&lt; <span class="stringliteral">"       space allocated and in use                  : "</span>&lt;&lt;st.<a class="code" href="classstxxl_1_1malloc__stats.html#a2">used</a>() &lt;&lt; <span class="stringliteral">" bytes"</span>&lt;&lt;std::endl;
00110   s &lt;&lt; <span class="stringliteral">"       space allocated but not in use              : "</span>&lt;&lt;st.<a class="code" href="classstxxl_1_1malloc__stats.html#a3">not_used</a>() &lt;&lt; <span class="stringliteral">" bytes"</span>&lt;&lt;std::endl;
00111   s &lt;&lt; <span class="stringliteral">"       top-most, releasable (via malloc_trim) space: "</span>&lt;&lt;st.<a class="code" href="classstxxl_1_1malloc__stats.html#a4">releasable</a>()&lt;&lt;<span class="stringliteral">" bytes"</span>&lt;&lt;std::endl;
00112   s &lt;&lt; <span class="stringliteral">"       maximum total allocated space (?)           : "</span>&lt;&lt;st.<a class="code" href="classstxxl_1_1malloc__stats.html#a5">max_allocated</a>()&lt;&lt;<span class="stringliteral">" bytes"</span>&lt;&lt;std::endl;
00113   s &lt;&lt; <span class="stringliteral">"   FASTBIN blocks "</span> &lt;&lt; std::endl;
00114   s &lt;&lt; <span class="stringliteral">"       number of fastbin blocks: "</span>&lt;&lt; st.<a class="code" href="classstxxl_1_1malloc__stats.html#a6">fastbin_blocks</a>() &lt;&lt; std::endl;
00115   s &lt;&lt; <span class="stringliteral">"       space available in freed fastbin blocks: "</span>&lt;&lt; st.<a class="code" href="classstxxl_1_1malloc__stats.html#a7">fastbin_free</a>() &lt;&lt; <span class="stringliteral">" bytes"</span>&lt;&lt;std::endl;
00116   s &lt;&lt; <span class="stringliteral">"Space allocated from system using mmap: "</span>&lt;&lt;st.<a class="code" href="classstxxl_1_1malloc__stats.html#a8">from_system_mmap</a>()&lt;&lt; <span class="stringliteral">" bytes"</span>&lt;&lt;std::endl;
00117   s &lt;&lt; <span class="stringliteral">"       number of chunks allocated via mmap(): "</span>&lt;&lt;st.<a class="code" href="classstxxl_1_1malloc__stats.html#a9">mmap_chunks</a>()&lt;&lt;std::endl;
00118   s &lt;&lt; <span class="stringliteral">"Total space allocated from system (mmap and not mmap): "</span>&lt;&lt;
00119           st.<a class="code" href="classstxxl_1_1malloc__stats.html#a10">from_system_total</a>() &lt;&lt; <span class="stringliteral">" bytes"</span> &lt;&lt;std::endl;
00120   s &lt;&lt; <span class="stringliteral">"================================================================="</span> &lt;&lt; std::endl ;
00121   <span class="keywordflow">return</span> s;
00122 }
00123 
00124 
00125 <span class="keyword">class </span>malloc_setup
00126 {
00127 };
00128 
00129 __STXXL_END_NAMESPACE
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Nov 26 10:56:52 2003 for <stxxl> by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>&lt;stxxl&gt;: inmemsort.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>inmemsort.h</h1><div class="fragment"><pre>00001 <span class="preprocessor">#ifndef IN_MEMORY_SORT_HEADER</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define IN_MEMORY_SORT_HEADER</span>
00003 <span class="preprocessor"></span><span class="comment">/***************************************************************************</span>
00004 <span class="comment"> *            inmemsort.h</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> *  Mon Apr  7 14:23:34 2003</span>
00007 <span class="comment"> *  Copyright  2003  Roman Dementiev</span>
00008 <span class="comment"> *  dementiev@mpi-sb.mpg.de</span>
00009 <span class="comment"> ****************************************************************************/</span>
00010 <span class="preprocessor">#include "../common/utils.h"</span>
00011 <span class="preprocessor">#include "../common/simple_vector.h"</span>
00012 <span class="preprocessor">#include "adaptor.h"</span>
00013 <span class="preprocessor">#include "../mng/adaptor.h"</span>
00014 <span class="preprocessor">#include &lt;algorithm&gt;</span>
00015 
00016 __STXXL_BEGIN_NAMESPACE
00017 
00018 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ExtIterator_,<span class="keyword">typename</span> StrictWeakOrdering_&gt;
00019 <span class="keywordtype">void</span> stl_in_memory_sort(ExtIterator_ first, ExtIterator_ last,StrictWeakOrdering_ cmp)
00020 {
00021         <span class="keyword">typedef</span> <span class="keyword">typename</span> ExtIterator_::vector_type::value_type value_type;
00022         <span class="keyword">typedef</span> <span class="keyword">typename</span> ExtIterator_::block_type block_type;
00023 
00024   <span class="keywordtype">unsigned</span> nblocks = last.bid() - first.bid() + (last.block_offset()?1:0); 
00025   simple_vector&lt;block_type&gt; blocks(nblocks);
00026   simple_vector&lt;request_ptr&gt; reqs(nblocks);
00027   <span class="keywordtype">unsigned</span> i;
00028   
00029   <span class="keywordflow">for</span>(i=0;i&lt;nblocks;i++)
00030     reqs[i] = blocks[i].read(*(first.bid() + i));
00031   <a class="code" href="group__iolayer.html#a3">wait_all</a>(reqs.begin(),nblocks);
00032   
00033   <span class="keywordtype">unsigned</span> last_block_correction = last.block_offset()?(block_type::size - last.block_offset()):0;
00034   <span class="keywordflow">if</span>(block_type::has_filler)
00035                 <a class="code" href="group__stlalgo.html#a12">std::sort</a>(
00036                               TwoToOneDimArrayRowAdaptor&lt; block_type,
00037                     <span class="keyword">typename</span> block_type::value_type,block_type::size &gt; (blocks.begin(), first.block_offset() ),
00038                               TwoToOneDimArrayRowAdaptor&lt; block_type,
00039                     <span class="keyword">typename</span> block_type::value_type,block_type::size &gt; (blocks.begin(), 
00040                             nblocks*block_type::size - last_block_correction)
00041                               ,cmp);
00042                 <span class="keywordflow">else</span> 
00043                         <a class="code" href="group__stlalgo.html#a12">std::sort</a>(blocks[0].elem + first.block_offset(), 
00044                 blocks[nblocks].elem - last_block_correction, cmp);
00045   
00046   <span class="keywordflow">for</span>(i=0;i&lt;nblocks;i++)
00047     reqs[i] = blocks[i].write(*(first.bid() + i));
00048   
00049   <a class="code" href="group__iolayer.html#a3">wait_all</a>(reqs.begin(),nblocks);
00050 };
00051 
00052 
00053 __STXXL_END_NAMESPACE
00054 
00055 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Nov 26 10:56:52 2003 for <stxxl> by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>

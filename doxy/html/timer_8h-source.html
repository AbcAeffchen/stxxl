<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>timer.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; <a class="qindex" href="examples.html">Examples</a> &nbsp; </center>
<hr><h1>timer.h</h1><div class="fragment"><pre>00001 <span class="preprocessor">#ifndef TIMER_HEADER</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define TIMER_HEADER</span>
00003 <span class="preprocessor"></span>
00004 <span class="comment">/* Simple timer class by Roman Dementiev </span>
00005 <span class="comment"> */</span>
00006 <span class="preprocessor">#include "../common/utils.h"</span>
00007 
00008 <span class="preprocessor">#include &lt;time.h&gt;</span>
00009 <span class="preprocessor">#include &lt;sys/time.h&gt;</span>
00010 
00011 
00012 __STXXL_BEGIN_NAMESPACE
00013 
00014 
00015 <span class="keyword">class </span>timer
00016 {
00017         <span class="keywordtype">bool</span> running;
00018         <span class="keywordtype">double</span> accumulated;
00019         <span class="keywordtype">double</span> last_clock;
00020         <span class="keywordtype">double</span> timestamp();
00021 <span class="keyword">public</span>:
00022         timer();
00023         <span class="keywordtype">void</span> start();
00024         <span class="keywordtype">void</span> stop();
00025         <span class="keywordtype">void</span> reset();
00026         <span class="keywordtype">double</span> seconds();
00027         <span class="keywordtype">double</span> mseconds();
00028         <span class="keywordtype">double</span> useconds();
00029 };
00030 
00031 timer::timer():running(false),accumulated(0.)
00032 {
00033 }
00034 
00035 <span class="keywordtype">double</span> timer::timestamp()
00036 {
00037         <span class="keyword">struct </span>timeval tp;
00038   gettimeofday(&amp;tp, NULL);
00039   <span class="keywordflow">return</span> double(tp.tv_sec) + tp.tv_usec / 1000000.;
00040 }
00041 
00042 <span class="keywordtype">void</span> timer::start()
00043 {
00044         running = <span class="keyword">true</span>;
00045         last_clock = timestamp();       
00046 }
00047 <span class="keywordtype">void</span> timer::stop()
00048 {
00049         running = <span class="keyword">false</span>;
00050         accumulated += timestamp() - last_clock;
00051 }
00052 <span class="keywordtype">void</span> timer::reset()
00053 {
00054         accumulated = 0.;
00055         last_clock = timestamp();
00056 }
00057 
00058 <span class="keywordtype">double</span> timer::mseconds()
00059 {
00060         <span class="keywordflow">if</span>(running)
00061                 <span class="keywordflow">return</span> (accumulated + timestamp() - last_clock)*1000.;
00062 
00063         <span class="keywordflow">return</span> (accumulated*1000.);
00064 }
00065 
00066 <span class="keywordtype">double</span> timer::useconds()
00067 {
00068         <span class="keywordflow">if</span>(running)
00069                 <span class="keywordflow">return</span> (accumulated + timestamp() - last_clock)*1000000.;
00070 
00071         <span class="keywordflow">return</span> (accumulated*1000000.);
00072 }
00073 
00074 <span class="keywordtype">double</span> timer::seconds()
00075 {
00076         <span class="keywordflow">if</span>(running)
00077                 <span class="keywordflow">return</span> (accumulated + timestamp() - last_clock);
00078         
00079         <span class="keywordflow">return</span> (accumulated);
00080 }
00081 
00082 __STXXL_END_NAMESPACE
00083 
00084 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Tue Jul 1 11:08:36 2003 for &lt;stxxl&gt; by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc1 </small></address>
</body>
</html>
